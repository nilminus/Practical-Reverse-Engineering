	global main
	global format
	global found
	extern printf
	extern exit
	extern puts
	extern strlen

	section .text

main:
	push rsi
	push rdi
	push rbx

	mov rdi, [rsi+8]
	call strlen
	mov rbx, rax	; rbx holds the length of the string

	mov rcx, rax	; iterate at maximum "length" number of times
	mov rdi, [rsi+8]
	mov rax, [rsi+16]
	mov al, [rax]
	cld
	repne scasb
	
	cmp rcx, 0
	jz found	
	sub rbx, rcx
	mov rcx, rbx

found:
	mov rsi, rcx
	mov rdi, format
	call printf

	pop rbx
	pop rdi
	pop rsi
	
	ret

format:
	db "The length is: %d", 10, 0
